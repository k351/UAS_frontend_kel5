<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
</head>

<body>
    <div class="transaction-history-container">
        <div class="history-header">
            <h1>Transaction History</h1>
        </div>

        <!-- Loading State -->
        <div ng-if="isLoading" class="loading-state">
            <div class="spinner"></div>
            <p>Loading your transaction history...</p>
        </div>

        <!-- Error State -->
        <div ng-if="errorMessage" class="error-state">
            <i class="fa-solid fa-triangle-exclamation"></i>
            <p>{{ errorMessage }}</p>
        </div>

        <!-- Transactions List -->
        <div ng-if="!isLoading && !errorMessage">
            <!-- No Transactions -->
            <div ng-if="transactions.length === 0" class="no-transactions">
                <p>No transaction history found.</p>
            </div>

            <!-- Transactions Iteration -->
            <div ng-repeat="transaction in transactions" class="transaction-card">
                <!-- Transaction Header -->
                <div class="transaction-header">
                    <span class="transaction-date">
                        {{ transaction.transactionDate | date:'medium' }}
                    </span>
                    <span class="transaction-id">
                        Transaction ID: {{ transaction._id }}
                    </span>
                </div>

                <!-- Transaction Items -->
                <div class="transaction-items">
                    <div ng-repeat="item in transaction.items" class="transaction-item">
                        <div class="item-image">
                            <img ng-src="{{ item.productId.image }}" alt="{{ item.productId.name }}">
                        </div>
                        <div class="item-details">
                            <h3>{{ item.productId.name }}</h3>
                            <p>Quantity: {{ item.quantity }}</p>
                            <p>Price: Rp {{ item.price | number }}</p>
                            <p>Subtotal: Rp {{ calculateItemTotal(item) | number }}</p>
                        </div>
                    </div>
                </div>

                <!-- Transaction Summary -->
                <div class="transaction-summary">
                    <div class="total-price">
                        <strong>Total:</strong> Rp {{ transaction.totalAmount | number }}
                    </div>
                    <div class="transaction-status">
                        Status: Completed
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>